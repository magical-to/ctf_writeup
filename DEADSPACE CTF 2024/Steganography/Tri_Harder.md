본 게시물은 2024년에 진행된 DEADSPACE CTF 2024의 Steganopraphy 부문에 관련된 문제에 대한 해설을 품고 있습니다.<br><br>

![1](https://github.com/user-attachments/assets/6e2c086f-21de-446e-87c9-cafaedb57437)<br><br>

문제 설명 : <br>
NexGen Softworks의 보안팀이 DEADFACE에 대한 잠재적인 제보와 관련하여 우리에게 연락해 왔다.<br>
인프라 업그레이드에 대해 한 직원과 서드파티 업체 간의 비정상적인 이메일 트래픽이 감지된 일이 발생하였다.<br>
이메일 체인은 겉보기에는 아무런 큰 문제가 없어 보이지만, NexGen의 SEIM(보안 정보 및 이벤트 관리 시스템)이 이를 의심스러운 것으로 표시했고, 그들은 그 이유를 찾지 못하고 있다.<br><br>

라고 한다...<br><br>

이 문제 풀이의 핵심은 이메일을 검사할 때, 각 이메일의 서명 블록 아래에 많은 공백이 있다는 점을 눈치채야 한다는 것이다.<br><br>

![2](https://github.com/user-attachments/assets/7b745e67-61d6-42b1-b111-f374eaac8ce0)<br>
문제의 이미지이다. NexGen Softworks라는 문구 밑에 추가적인 빈 공백 줄이 존재한다.<br><br>

![3](https://github.com/user-attachments/assets/bbf5978d-209e-48e3-b0f3-f0cb038e9092)<br>
이 공백을 복사하여 16진수로 변환하면, 세 가지 구분되는 유니코드 공백 문자를 발견할 수 있다. U+200A, U+2002, U+2009.<br><br>

이 공백 문자들은 메시지를 암호화하는 데 사용되었을 가능성이 있으며, 특정 패턴을 통해 숨겨진 정보를 드러낼 수 있다.<br><br>

![4](https://github.com/user-attachments/assets/815c009e-279a-4371-9ac0-575e902f83a4)<br>
유니코드를 삼진법으로 변환해야 한다.<br><br>

문제의 제목이 삼진법(기수법 3)인 것이 힌트이며, 여기서 각 유니코드 문자가 0, 1, 2를 나타내는지를 알아내야 하는데 여기는 약간 감이다.<br><br>

아래와 같이 각 유니코드 문자 코드에 해당하는 삼진법 숫자로 변환할 수 있다.<br><br>

U+200A: 0<br>
U+2002: 1<br>
U+2009: 2<br><br>

이렇게 유니코드 공백 문자를 각각 0, 1, 2로 변환한 후, 삼진법 숫자로 변환해 진행을 할 수 있다.<br><br>

삼진법(기수법 3) 숫자를 이진법(기수법 2) 숫자로 변환하는 Python 코드 예제가 있는데,<br><br>

![temp](https://github.com/user-attachments/assets/99f83ada-d99c-41d6-9611-13836385ec6a)<br>
바로 요 친구이다.<br><br>

만약 이 코드가 구동이 되지 않는다면, 온라인 변환 웹인 (https://www.webconversiononline.com/number-conversion.aspx?from=binary&to=ternary) 요기 이용해주면 된다.<br><br>

변환 결과는 다음과 같다.<br>
110010000110011001101000111010001101000001011000010000001001001001000000110001101100001011011100010011101110100001000000110011101100101011101000010000001100001011101110110000101111001001000000110011001110010011011110110110100100000011101000110100001100101001000000110111101100110011001100110100101100011011001010010111000100000010011000110010101110100001001110111001100100000011000110110111101101101011011010111010101101110011010010110001101100001011101000110010100100000011101010111001101101001011011100110011100100000011101000110100001101001011100110010000001110111011010000110100101110100011001010111001101110000011000010110001101100101001000000111001101110100011001010110011100101110<br><br>


![5](https://github.com/user-attachments/assets/c1f3db9c-441c-475b-83b0-dd1c1287aadd)<br>
이진수를 가독성 있는 평문으로 변환하려면 각 바이트(8비트)를 정확히 맞춰야 하며, 앞에 0이 누락되면 해석이 잘못될 수 있다.<br>
따라서, 8비트로 정렬하도록 이진수를 조정해야 한다.<br><br>

![6](https://github.com/user-attachments/assets/a013122a-7351-4c2f-a8e8-0c90e5852f11)<br>
맨 앞에 0을 집어넣으면 숨어 있던 메시지를 획득할 수 있게 된다.<br><br>

![7](https://github.com/user-attachments/assets/8b27a967-bc71-4ba4-beaa-7926a9b119ba)<br>
flag{1n51d3r5_0p3n_7h3_D00r5}<br><br><br>


스테가노그래피는 창의력, 문제 해결 능력, 기술력이 조화를 이루는 매력적인 분야인 것 같다.<br>
작성된 해설이 도움이 되었길...<br>
숨겨진 정보를 발견하는 스릴이야말로 스테가노그래피를 보람 있게 만들고 후의 대회에서 더 많은 다양한 솔루션을 만나보고 싶다.<br>
