# The Covert Exchange

μ΄ μ±λ¦°μ§€λ” Wiresharkμ—μ„ **ν¨ν‚· μΊ΅μ²(PCAP)** νμΌμ„ λ¶„μ„ν•λ” κ³Όμ μ΄λ‹¤. λ©ν‘λ” **UDP ν¨ν‚·**μ— μ¨κ²¨μ§„ **AES μ•”νΈν™”λ λ©”μ‹μ§€**λ¥Ό μ¶”μ¶ν•κ³ , **TCP ν¨ν‚·**μ— μ¨κ²¨μ§„ ν‚¤λ¥Ό μ‚¬μ©ν•΄ λ©”μ‹μ§€λ¥Ό λ³µνΈν™”ν•λ” κ²ƒμ΄λ‹¤.

---

## π“ Step 1: ν¨ν‚· λ¶„μ„ν•κΈ°

PCAP νμΌμ„ Wiresharkμ—μ„ μ—΄κ³  μΊ΅μ²λ ν¨ν‚·μ„ λ¶„μ„ν•΄ λ³Ό κ²ƒμ΄λ‹¤.
ν¨ν‚·μ„ μ •λ ¬ν•΄ λ³΄λ©΄ **TCP, UDP, HTTPS** λ“±μ λ‹¤μ–‘ν• ν”„λ΅ν† μ½μ΄ ν¬ν•¨λ κ²ƒμ„ ν™•μΈν•  μ μλ‹¤.

![alt text](1.png)

---

## π“ Step 2: UDP ν¨ν‚· μ‹λ³„ν•κΈ°

1. **UDP ν¨ν‚· ν•„ν„°λ§**

   - ν•„ν„°μ— `udp`λ¥Ό μ…λ ¥ν•μ—¬ UDP ν¨ν‚·λ§ ν‘μ‹ν•λ‹¤.

2. **ν¨ν‚· μ •λ ¬ λ° λ°μ΄ν„° μ¶”μ¶**
   - λ™μΌν• μ†μ¤ IPμ—μ„ μ—¬λ¬ κ°μ λ©μ μ§€ IPλ΅ μ „μ†΅λ **8κ°μ UDP ν¨ν‚·**μ„ ν™•μΈν•λ‹¤.
   - μ΄ ν¨ν‚·λ“¤μ λ°μ΄ν„°λ¥Ό μ¶”μ¶ν• λ’¤, **λ©μ μ§€ IP κΈ°μ¤€μΌλ΅ μ •λ ¬**ν•λ©΄ **AES μ•”νΈν™”λ ν…μ¤νΈ**κ°€ λ‚νƒ€λ‚λ‹¤.

### β… Alternative Method:

- Wiresharkμ **ν”„λ΅ν† μ½ κ³„μΈµ λ³΄κΈ°** μ‚¬μ©ν•κΈ°  
  β†’ **Statistics > Protocol Hierarchy** λ©”λ‰΄μ—μ„ ν•„ν„°λ¥Ό μ μ©ν•΄ UDP ν¨ν‚·μ„ μ°Ύμ„ μ μλ‹¤.

---

## π“ Step 3: λ³µνΈν™” ν‚¤ μ°ΎκΈ°

AESλ΅ μ•”νΈν™”λ λ©”μ‹μ§€λ¥Ό λ³µνΈν™”ν•λ ¤λ©΄ μ•”νΈν™” ν‚¤λ¥Ό μ°Ύμ•„μ•Ό ν•λ‹¤.

1. **HTTPS ν¨ν‚· ν™•μΈ**
   - HTTPS ν¨ν‚·μ—μ„ Base64λ΅ μΈμ½”λ”©λ μ •λ³΄λ¥Ό ν™•μΈν•  μ μλ‹¤.
   - κ·Έλ¬λ‚ Base64λ¥Ό λ””μ½”λ”©ν•΄ λ³΄λ©΄ **κ°€μ§ ν”λκ·Έ**(Decoy)λ΅ νλ…λλ‹¤.

![alt text](2.png)

2. **TCP ν¨ν‚· ν™•μΈ**
   - TCP ν¨ν‚·μ—μ„ λ‹¤λ¥Έ λ€ν™” λ‚΄μ©μ„ μ°Ύλ”λ‹¤.
   - μ΄ λ€ν™” μ¤‘μ—μ„ **RSAλ΅ μ•”νΈν™”λ λ©”μ‹μ§€**κ°€ ν¬ν•¨λ κ²ƒμ„ ν™•μΈν•λ‹¤.

![alt text](3.png)

---

## π“ Step 4: AES ν‚¤ μ¶”μ¶ν•κΈ°

1. μ κ³µλ κ³µκ° ν‚¤(public key)λ¥Ό μ‚¬μ©ν•΄ RSA μ•”νΈν™”λ λ©”μ‹μ§€λ¥Ό λ³µνΈν™”ν•λ‹¤.
2. λ³µνΈν™”λ λ©”μ‹μ§€μ—μ„ **AES ν‚¤**λ¥Ό μ¶”μ¶ν•λ‹¤.

```plaintext
thisisasecretkey
```

<br><br>

μ¶”μ¶ν• AES ν‚¤λ¥Ό μ‚¬μ©ν•΄ UDP ν¨ν‚·μ—μ„ μ¶”μ¶ν• λ©”μ‹μ§€λ¥Ό λ³µνΈν™”ν•λ©΄?<br>
λ³µνΈν™”λ λ©”μ‹μ§€μ—μ„ μµμΆ… ν”λκ·Έλ¥Ό μ–»μ„ μ μλ‹¤.<br><br>

pearl{tcp_hides_keys_udp_hides_flag}
