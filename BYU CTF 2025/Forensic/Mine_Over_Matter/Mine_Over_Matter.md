# 🧠 Mine Over Matter - BYUCTF 2025

## 📜 문제 설명

> SOC가 네트워크 구간에서 비정상적인 **아웃바운드 트래픽**을 탐지함.  
> 라우터에서 이상이 발생한 시점의 로그를 캡처해 네트워크 분석 담당자에게 전달함.  
> 로그 어딘가에, **암호화폐를 채굴 중인 감염된 호스트 2대**가 숨어 있음.  
> 트래픽을 분석해 해당 IP 주소 2개를 식별하고, Incident Response 팀에 보고해야 함.  
>
> **플래그 형식**: `byuctf{IP1,IP2}` *(순서는 상관 없음)*  
> **문제 출제자**: Welsh Dragon  
> **[로그 파일 다운로드 링크](https://byu.box.com/s/2rong02xtfx7sfo52nos3ra2waifogv2)*

---

## 🔧 풀이 전략

네트워크 로그 파일을 받아 다음 작업을 수행함:

1. 로그 파일을 파싱함  
2. 모든 **목적지 IP**를 추출함  
3. 목적지 IP에 대해 **역방향 DNS 조회**를 수행함  
4. 암호화폐 채굴 도메인(mining pool 등)과 관련된 트래픽을 판별함  
5. 해당 도메인에 접근한 **내부 IP**를 식별함

---

## 💡 핵심 포인트

내부 IP `172.16.0.5`와 `172.16.0.10`이  
반복적으로 **암호화폐 채굴 풀 도메인** (예: `minexmr.com`)에 접속하고 있었음.  

`solve.py` 스크립트를 작성하여:

- 로그에서 목적지 IP를 추출함
- `socket.gethostbyaddr()` 또는 `dig -x`를 통해 도메인 확인함
- 채굴 서비스와 연관된 IP를 판별함
- 해당 IP에 접근한 내부 IP를 출력함

---

## 🏁 최종 플래그

byuctf{172.16.0.5,172.16.0.10}
